<?php

class {{ migrationClass }} extends AbstractMigration
{
    public function up()
    {
        ${{ variableName }} = $this->table('{{ table }}', ['primary_key' => '{{ primaryKey }}']);

        {{#each columns}}
        ${{ variableName }}->addColumn('{{ this.name }}', '{{ this.type.type }}'{{#if this.options}}, [
            {{#each this.options}}
                '{{@key}}' => {{this}}
            {{/each}}
        ]{{/if}})
            {{#each dependencies}}
                {{#eq this.sourceColumn @root.father.name }}
                FUUUUUUUUUUCK
                ->addForeignKey(
                    {{this.sourceColumn}}, {{this.referencedTable}}, {{this.referencedColumn}}, 
                    ['delete' => {{this.deleteRule}}, 'update' => {{this.updateRule}}]
                );
                {{/eq}}
            {{/each}}
        {{/each}}

        ${{ variableName }}->save();
    }

    public function down()
    {
        $this->dropTable('{{ table }}');
    }
}